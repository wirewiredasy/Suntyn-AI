{% extends "base.html" %}

{% block title %}{{ tool_name.replace('-', ' ').title() }} - Toolora AI{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <!-- Breadcrumb -->
    <nav class="flex mb-8 animate__animated animate__fadeInDown" aria-label="Breadcrumb">
        <ol class="inline-flex items-center space-x-1 md:space-x-3">
            <li class="inline-flex items-center">
                <a href="{{ url_for('main.index') }}" class="inline-flex items-center text-sm font-medium text-gray-700 hover:text-blue-600 dark:text-gray-400 dark:hover:text-white">
                    <i data-lucide="home" class="w-4 h-4 mr-2"></i>
                    Home
                </a>
            </li>
            <li>
                <div class="flex items-center">
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i>
                    <a href="{{ url_for('tools.index') }}" class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white">Tools</a>
                </div>
            </li>
            <li>
                <div class="flex items-center">
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i>
                    <a href="{{ url_for('tools.index', category=tool_category) }}" class="ml-1 text-sm font-medium text-gray-700 hover:text-blue-600 md:ml-2 dark:text-gray-400 dark:hover:text-white">
                        {{ tool_info.name }}
                    </a>
                </div>
            </li>
            <li aria-current="page">
                <div class="flex items-center">
                    <i data-lucide="chevron-right" class="w-4 h-4 text-gray-400"></i>
                    <span class="ml-1 text-sm font-medium text-gray-500 md:ml-2 dark:text-gray-400">{{ tool_name.replace('-', ' ').title() }}</span>
                </div>
            </li>
        </ol>
    </nav>

    <!-- Tool Header -->
    <div class="text-center mb-12 animate__animated animate__fadeInUp">
        <div class="inline-flex items-center justify-center w-20 h-20 rounded-2xl bg-{{ tool_info.color }}-100 dark:bg-{{ tool_info.color }}-900 mb-6">
            <i data-lucide="{{ tool_info.icon }}" class="w-10 h-10 text-{{ tool_info.color }}-600 dark:text-{{ tool_info.color }}-400"></i>
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-gray-800 dark:text-white mb-4">
            {{ tool_name.replace('-', ' ').title() }}
        </h1>
        <p class="text-xl text-gray-600 dark:text-gray-300 max-w-2xl mx-auto mb-6">
            Professional {{ tool_name.replace('-', ' ') }} tool - Fast, secure, and free to use.
        </p>
        <div class="flex items-center justify-center space-x-6 text-sm text-gray-500 dark:text-gray-400">
            <div class="flex items-center space-x-1">
                <i data-lucide="shield-check" class="w-4 h-4"></i>
                <span>100% Secure</span>
            </div>
            <div class="flex items-center space-x-1">
                <i data-lucide="zap" class="w-4 h-4"></i>
                <span>Fast Processing</span>
            </div>
            <div class="flex items-center space-x-1">
                <i data-lucide="download" class="w-4 h-4"></i>
                <span>No Registration</span>
            </div>
        </div>
    </div>

    <!-- Tool Interface -->
    <div class="max-w-4xl mx-auto">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-200 dark:border-gray-700 animate__animated animate__fadeInUp animate__delay-1s">
            <div class="p-8">
                <!-- File Upload Area -->
                <div id="upload-area" class="border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl p-12 text-center hover:border-{{ tool_info.color }}-400 dark:hover:border-{{ tool_info.color }}-500 transition-colors duration-300 cursor-pointer" 
                     ondrop="handleDrop(event)" ondragover="handleDragOver(event)" ondragenter="handleDragEnter(event)" ondragleave="handleDragLeave(event)">
                    <div class="space-y-4">
                        <div class="w-16 h-16 mx-auto bg-{{ tool_info.color }}-100 dark:bg-{{ tool_info.color }}-900 rounded-xl flex items-center justify-center">
                            <i data-lucide="upload-cloud" class="w-8 h-8 text-{{ tool_info.color }}-600 dark:text-{{ tool_info.color }}-400"></i>
                        </div>
                        <div>
                            <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">
                                Drop your files here or click to browse
                            </h3>
                            <p class="text-gray-500 dark:text-gray-400">
                                Supports multiple file formats. Maximum file size: 16MB
                            </p>
                        </div>
                        <input type="file" id="file-input" class="hidden" multiple accept="*/*" onchange="handleFileSelect(event)">
                        <button onclick="document.getElementById('file-input').click()" 
                                class="btn btn-primary btn-lg px-8 py-3">
                            <i data-lucide="folder-open" class="w-5 h-5 mr-2"></i>
                            Select Files
                        </button>
                    </div>
                </div>

                <!-- File List -->
                <div id="file-list" class="hidden mt-8">
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Selected Files</h4>
                    <div id="files-container" class="space-y-3"></div>
                </div>

                <!-- Process Button -->
                <div id="process-section" class="hidden mt-8 text-center">
                    <button id="process-btn" onclick="processFiles()" 
                            class="btn btn-primary btn-lg px-12 py-4 text-lg">
                        <i data-lucide="play" class="w-5 h-5 mr-2"></i>
                        Process Files
                    </button>
                </div>

                <!-- Progress -->
                <div id="progress-section" class="hidden mt-8">
                    <div class="bg-gray-200 dark:bg-gray-700 rounded-full h-3 mb-4">
                        <div id="progress-bar" class="bg-{{ tool_info.color }}-600 h-3 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <p id="progress-text" class="text-center text-gray-600 dark:text-gray-300">Processing files...</p>
                </div>

                <!-- Results -->
                <div id="results-section" class="hidden mt-8">
                    <h4 class="text-lg font-semibold text-gray-900 dark:text-white mb-4">Processed Files</h4>
                    <div id="results-container" class="space-y-3"></div>
                </div>
            </div>
        </div>

        <!-- Tool Information -->
        <div class="mt-12 grid grid-cols-1 md:grid-cols-3 gap-8 animate__animated animate__fadeInUp animate__delay-2s">
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
                <div class="w-12 h-12 bg-blue-100 dark:bg-blue-900 rounded-lg flex items-center justify-center mb-4">
                    <i data-lucide="shield" class="w-6 h-6 text-blue-600 dark:text-blue-400"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">Secure Processing</h3>
                <p class="text-gray-600 dark:text-gray-300">All files are processed locally and automatically deleted after processing.</p>
            </div>
            
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
                <div class="w-12 h-12 bg-green-100 dark:bg-green-900 rounded-lg flex items-center justify-center mb-4">
                    <i data-lucide="zap" class="w-6 h-6 text-green-600 dark:text-green-400"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">Fast & Efficient</h3>
                <p class="text-gray-600 dark:text-gray-300">Optimized algorithms ensure quick processing without compromising quality.</p>
            </div>
            
            <div class="bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-200 dark:border-gray-700">
                <div class="w-12 h-12 bg-purple-100 dark:bg-purple-900 rounded-lg flex items-center justify-center mb-4">
                    <i data-lucide="heart" class="w-6 h-6 text-purple-600 dark:text-purple-400"></i>
                </div>
                <h3 class="text-lg font-semibold text-gray-900 dark:text-white mb-2">Always Free</h3>
                <p class="text-gray-600 dark:text-gray-300">No registration required. All tools are completely free to use.</p>
            </div>
        </div>
    </div>
</div>

<script>
// File handling functionality
let selectedFiles = [];

function handleDragOver(e) {
    e.preventDefault();
    e.stopPropagation();
}

function handleDragEnter(e) {
    e.preventDefault();
    e.stopPropagation();
    e.target.closest('#upload-area').classList.add('border-{{ tool_info.color }}-400', 'bg-{{ tool_info.color }}-50', 'dark:bg-{{ tool_info.color }}-900');
}

function handleDragLeave(e) {
    e.preventDefault();
    e.stopPropagation();
    e.target.closest('#upload-area').classList.remove('border-{{ tool_info.color }}-400', 'bg-{{ tool_info.color }}-50', 'dark:bg-{{ tool_info.color }}-900');
}

function handleDrop(e) {
    e.preventDefault();
    e.stopPropagation();
    e.target.closest('#upload-area').classList.remove('border-{{ tool_info.color }}-400', 'bg-{{ tool_info.color }}-50', 'dark:bg-{{ tool_info.color }}-900');
    
    const files = Array.from(e.dataTransfer.files);
    addFiles(files);
}

function handleFileSelect(e) {
    const files = Array.from(e.target.files);
    addFiles(files);
}

function addFiles(files) {
    selectedFiles = [...selectedFiles, ...files];
    displayFiles();
    document.getElementById('file-list').classList.remove('hidden');
    document.getElementById('process-section').classList.remove('hidden');
}

function displayFiles() {
    const container = document.getElementById('files-container');
    container.innerHTML = '';
    
    selectedFiles.forEach((file, index) => {
        const fileElement = document.createElement('div');
        fileElement.className = 'flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-700 rounded-lg';
        fileElement.innerHTML = `
            <div class="flex items-center space-x-3">
                <i data-lucide="file" class="w-5 h-5 text-gray-400"></i>
                <div>
                    <div class="font-medium text-gray-900 dark:text-white">${file.name}</div>
                    <div class="text-sm text-gray-500 dark:text-gray-400">${formatFileSize(file.size)}</div>
                </div>
            </div>
            <button onclick="removeFile(${index})" class="text-red-500 hover:text-red-700">
                <i data-lucide="x" class="w-4 h-4"></i>
            </button>
        `;
        container.appendChild(fileElement);
    });
    
    // Re-initialize Lucide icons for new elements
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}

function removeFile(index) {
    selectedFiles.splice(index, 1);
    displayFiles();
    
    if (selectedFiles.length === 0) {
        document.getElementById('file-list').classList.add('hidden');
        document.getElementById('process-section').classList.add('hidden');
    }
}

function formatFileSize(bytes) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
}

function processFiles() {
    if (selectedFiles.length === 0) return;
    
    document.getElementById('progress-section').classList.remove('hidden');
    document.getElementById('process-btn').disabled = true;
    
    // Simulate processing (replace with actual API call)
    simulateProcessing();
}

function simulateProcessing() {
    let progress = 0;
    const interval = setInterval(() => {
        progress += Math.random() * 20;
        if (progress >= 100) {
            progress = 100;
            clearInterval(interval);
            showResults();
        }
        
        document.getElementById('progress-bar').style.width = progress + '%';
        document.getElementById('progress-text').textContent = `Processing files... ${Math.round(progress)}%`;
    }, 500);
}

function showResults() {
    document.getElementById('results-section').classList.remove('hidden');
    document.getElementById('progress-text').textContent = 'Processing complete!';
    
    const container = document.getElementById('results-container');
    container.innerHTML = '';
    
    selectedFiles.forEach(file => {
        const resultElement = document.createElement('div');
        resultElement.className = 'flex items-center justify-between p-4 bg-green-50 dark:bg-green-900 rounded-lg border border-green-200 dark:border-green-700';
        resultElement.innerHTML = `
            <div class="flex items-center space-x-3">
                <i data-lucide="check-circle" class="w-5 h-5 text-green-600"></i>
                <div>
                    <div class="font-medium text-gray-900 dark:text-white">processed_${file.name}</div>
                    <div class="text-sm text-gray-500 dark:text-gray-400">Ready for download</div>
                </div>
            </div>
            <button class="btn btn-sm btn-primary">
                <i data-lucide="download" class="w-4 h-4 mr-1"></i>
                Download
            </button>
        `;
        container.appendChild(resultElement);
    });
    
    // Re-initialize Lucide icons
    if (typeof lucide !== 'undefined') {
        lucide.createIcons();
    }
}

// Initialize upload area click handler
document.getElementById('upload-area').addEventListener('click', () => {
    document.getElementById('file-input').click();
});
</script>
{% endblock %}